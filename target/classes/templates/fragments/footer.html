<div th:fragment="siteFooter">
  <style>
    .footer-enhanced {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white !important;
    }
    .footer-enhanced * {
      color: inherit;
    }
    .footer-enhanced .text-muted {
      color: #bdc3c7 !important;
    }
    .footer-section h6 {
      color: #3498db;
      font-weight: 700;
      margin-bottom: 1rem;
      position: relative;
    }
    .footer-section h6:after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 30px;
      height: 2px;
      background: #3498db;
    }
    .footer-link {
      color: #bdc3c7;
      text-decoration: none;
      transition: all 0.3s ease;
      display: block;
      padding: 0.25rem 0;
    }
    .footer-link:hover {
      color: #3498db;
      padding-left: 5px;
    }
    .social-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: rgba(52, 152, 219, 0.1);
      border: 2px solid rgba(52, 152, 219, 0.3);
      border-radius: 50%;
      color: #3498db;
      text-decoration: none;
      transition: all 0.3s ease;
      margin: 0 0.5rem;
    }
    .social-icon:hover {
      background: #3498db;
      color: white;
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
    }
    .footer-bottom {
      background: rgba(0,0,0,0.2);
      border-top: 1px solid rgba(255,255,255,0.1);
    }
    .contact-info {
      background: rgba(52, 152, 219, 0.1);
      border-radius: 10px;
      padding: 1.5rem;
      border-left: 4px solid #3498db;
    }
    .payment-section {
      background: linear-gradient(135deg, rgba(52, 152, 219, 0.1) 0%, rgba(41, 128, 185, 0.05) 100%);
      border-radius: 10px;
      padding: 0.35rem 0.5rem;
      border: 1px solid rgba(52, 152, 219, 0.3);
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
    }
    .payment-section::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(52, 152, 219, 0.1) 0%, transparent 70%);
      animation: pulse 3s ease-in-out infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.1); opacity: 0.8; }
    }
    .payment-section:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 20px rgba(52, 152, 219, 0.3);
      border-color: rgba(52, 152, 219, 0.5);
    }
    .payment-image-container {
      position: relative;
      z-index: 1;
      background: white;
      border-radius: 4px;
      padding: 0.05rem;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);
      transition: all 0.3s ease;
      max-width: 400px;
      max-height: 70px;
      margin: 0;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .payment-image-container:hover {
      transform: scale(1.02);
      box-shadow: 0 5px 20px rgba(52, 152, 219, 0.3);
    }
    .payment-image {
      max-width: 100%;
      max-height: 65px;
      height: auto;
      object-fit: contain;
      display: block;
      border-radius: 3px;
      padding: 5px;
    }
    
    /* Payment Options Styling */
    .payment-options-container {
      position: relative;
      z-index: 1;
      max-width: 600px;
      margin: 0 auto;
    }
    
    .payment-type-btn {
      transition: all 0.3s ease;
      border-radius: 20px;
      padding: 0.25rem 0.75rem;
      font-size: 0.8rem;
    }
    
    .payment-type-btn.active {
      background-color: #0d6efd;
      color: white;
      border-color: #0d6efd;
    }
    
    .payment-form-container {
      background: rgba(255, 255, 255, 0.1);
      padding: 1rem;
      border-radius: 8px;
      margin-top: 0.5rem;
      border: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    @media (max-width: 768px) {
      .payment-type-btn {
        width: 100%;
        margin-bottom: 0.5rem;
      }
      
      .payment-options-container {
        padding: 0 10px;
      }
      
      #customPayBtn, #qrPayBtn {
        font-size: 0.75rem;
        padding: 0.25rem 0.5rem;
      }
    }
    .secure-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
      color: white;
      padding: 0.35rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      box-shadow: 0 3px 10px rgba(39, 174, 96, 0.25);
      animation: bounce 2s ease-in-out infinite;
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }
    .payment-title {
      position: relative;
      z-index: 1;
      font-size: 1rem;
      font-weight: 700;
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.4rem;
    }
    @media (max-width: 768px) {
      .payment-section .row {
        text-align: center;
      }
      .payment-image-container {
        max-width: 100%;
        margin-top: 1rem;
      }
      .payment-image {
        max-height: 50px;
      }
      #customPaymentAmount {
        max-width: 100%;
      }
    }
    @media (max-width: 576px) {
      .payment-section {
        padding: 1rem;
      }
      .payment-image-container {
        max-width: 90%;
        margin: 1rem auto;
      }
      .payment-image {
        max-height: 40px;
      }
      #customPaymentAmount {
        font-size: 14px;
      }
    }
  </style>
  
  <footer class="footer-enhanced mt-auto">
    <!-- Main Footer Content -->
    <div class="py-5">
      <div class="container">
        <div class="row g-4">
          <!-- Company Info -->
          <div class="col-lg-4 col-md-6">
            <div class="footer-section">
              <h6>About HappyGhumakkads</h6>
              <p class="text-muted mb-3">Your trusted travel partner for unforgettable journeys across India and beyond. We specialize in creating personalized travel experiences that combine adventure, culture, and comfort.</p>
              <div class="contact-info">
                <div class="d-flex align-items-center mb-2">
                  <i class="fa fa-map-marker-alt me-3 text-primary"></i>
                  <small th:text="${@environment.getProperty('brand.address')}">Address</small>
                </div>
                <div class="d-flex align-items-center mb-2">
                  <i class="fa fa-phone me-3 text-primary"></i>
                  <a class="footer-link d-inline" th:href="${'tel:' + @environment.getProperty('brand.phone')}" th:text="${@environment.getProperty('brand.phone')}">+91</a>
                </div>
                <div class="d-flex align-items-center">
                  <i class="fa fa-envelope me-3 text-primary"></i>
                  <a class="footer-link d-inline" th:href="${'mailto:' + @environment.getProperty('brand.email')}" th:text="${@environment.getProperty('brand.email')}">email</a>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Quick Links -->
          <div class="col-lg-2 col-md-6">
            <div class="footer-section">
              <h6>Quick Links</h6>
              <a href="/" class="footer-link">Home</a>
              <a href="/about" class="footer-link">About Us</a>
              <a href="/packages" class="footer-link">Packages</a>
              <a href="/contact" class="footer-link">Contact</a>
              <a href="/careers" class="footer-link">Careers</a>
            </div>
          </div>
          
          <!-- Tour Categories -->
          <div class="col-lg-3 col-md-6">
            <div class="footer-section">
              <h6>Tour Categories</h6>
              <a href="/international-tour" class="footer-link">
                <i class="fa fa-plane me-2"></i>International Tours
              </a>
              <a href="/domestic-tour" class="footer-link">
                <i class="fa fa-map-location-dot me-2"></i>Domestic Tours
              </a>
              <a href="/industrial-tour" class="footer-link">
                <i class="fa fa-building me-2"></i>Corporate Events
              </a>
              <a href="/students-group-tour" class="footer-link">
                <i class="fa fa-graduation-cap me-2"></i>Student Groups
              </a>
            </div>
          </div>
          
          <!-- Popular Destinations -->
          <div class="col-lg-3 col-md-6">
            <div class="footer-section">
              <h6>Popular Destinations</h6>
              <a href="/domestic-tour" class="footer-link">Golden Triangle</a>
              <a href="/domestic-tour" class="footer-link">Kerala Backwaters</a>
              <a href="/domestic-tour" class="footer-link">Himachal Pradesh</a>
              <a href="/domestic-tour" class="footer-link">Goa Beaches</a>
              <a href="/domestic-tour" class="footer-link">Kashmir Valley</a>
              <a href="/international-tour" class="footer-link">Dubai & UAE</a>
              <a href="/international-tour" class="footer-link">Singapore</a>
              <a href="/international-tour" class="footer-link">Thailand</a>
            </div>
          </div>
        </div>
        
        <!-- Newsletter & Social -->
        <div class="row mt-4 pt-4" style="border-top: 1px solid rgba(255,255,255,0.1);">
          <div class="col-md-8">
            <h6 class="text-primary mb-3">Stay Connected</h6>
            <p class="text-muted mb-3">Follow us for travel inspiration, exclusive deals, and destination updates</p>
            <div class="d-flex flex-wrap">
              <a href="#" th:href="${@environment.getProperty('brand.instagram')}" target="_blank" class="social-icon">
                <i class="fab fa-instagram"></i>
              </a>
              <a href="#" th:href="${@environment.getProperty('brand.facebook')}" target="_blank" class="social-icon">
                <i class="fab fa-facebook"></i>
              </a>
              <a href="https://wa.me/918447133338" target="_blank" class="social-icon">
                <i class="fab fa-whatsapp"></i>
              </a>
              <a href="tel:+918447133338" class="social-icon">
                <i class="fa fa-phone"></i>
              </a>
              <a href="mailto:happyghumakkads@gmail.com" class="social-icon">
                <i class="fa fa-envelope"></i>
              </a>
            </div>
          </div>
          <div class="col-md-4 text-md-end">
            <h6 class="text-primary mb-3">Business Hours</h6>
            <div class="text-muted">
              <div><i class="fa fa-clock me-2"></i>Mon - Sat: 9:00 AM - 7:00 PM</div>
              <div><i class="fa fa-clock me-2"></i>Sunday: Emergency Only</div>
              <div class="mt-2">
                <span class="badge bg-success">
                  <i class="fa fa-phone me-1"></i>24x7 Support Available
                </span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Payment Options Section -->
        <div class="row mt-3 pt-2" style="border-top: 1px solid rgba(255,255,255,0.1);">
          <div class="col-12">
            <div class="payment-section">
              <div class="row align-items-center g-1">
                <div class="col-lg-4 mb-0 text-center text-lg-start">
                  <h6 class="payment-title mb-1">
                    <i class="fas fa-shield-alt me-1"></i>Secure Payments
                  </h6>
                  <p class="text-muted mb-1 small" style="position: relative; z-index: 1; font-size: 0.8rem;">
                    Multiple payment options
                  </p>
                  <div class="secure-badge">
                    <i class="fas fa-lock"></i>
                    <span>100% Secure</span>
                  </div>
                  <!-- Payment Options Section -->
                  <div class="mt-3 payment-options-container">
                    <!-- Payment Type Toggle Buttons -->
                    <div class="d-flex flex-wrap gap-2 mb-2">
                      <button class="btn btn-outline-primary btn-sm payment-type-btn active" data-type="partial">
                        <i class="fas fa-percentage me-1"></i>Make Partial Payment
                      </button>
                      <button class="btn btn-outline-success btn-sm payment-type-btn" data-type="advance">
                        <i class="fas fa-hand-holding-usd me-1"></i>Make Advance Payment
                      </button>
                    </div>
                    
                    <!-- Payment Form (initially hidden) -->
                    <div class="payment-form-container" style="display: none;">
                      <div class="input-group input-group-sm mb-2" style="max-width: 100%;">
                        <span class="input-group-text bg-white">
                          <i class="fas fa-rupee-sign"></i>
                        </span>
                        <input type="number" 
                               class="form-control" 
                               id="customPaymentAmount" 
                               placeholder="Enter amount" 
                               min="1"
                               style="border-left: 0;">
                        <button class="btn btn-primary" 
                                id="customPayBtn"
                                style="min-width: 120px;">
                          <i class="fas fa-credit-card me-1"></i>Pay Now
                        </button>
                        <button class="btn btn-outline-secondary" 
                                id="qrPayBtn"
                                style="min-width: 120px;">
                          <i class="fas fa-qrcode me-1"></i>Pay with QR
                        </button>
                      </div>
                      <div class="d-flex align-items-center">
                        <small class="text-muted" style="font-size: 0.7rem;">
                          <i class="fas fa-info-circle me-1"></i>Secure payment powered by Razorpay
                        </small>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-8 d-flex align-items-center justify-content-end">
                  <div class="payment-image-container">
                    <img src="/images/Payment-Option.jpeg" 
                         alt="Payment Options - Credit Card, Debit Card, UPI, Net Banking, Wallets" 
                         class="payment-image"
                         loading="lazy">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Footer Bottom -->
    <div class="footer-bottom py-3">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-md-6">
            <p class="mb-0 text-muted">
              &copy; 2025 <span th:text="${@environment.getProperty('brand.name')}">HappyGhumakkads</span>. 
              All rights reserved. | Made with <i class="fa fa-heart text-danger"></i> for travelers
            </p>
          </div>
          <div class="col-md-6 text-md-end">
            <div class="d-flex justify-content-md-end justify-content-start flex-wrap gap-3 mt-2 mt-md-0">
              <a th:href="@{/privacy-policy}" class="footer-link d-inline">Privacy Policy</a>
              <a th:href="@{/terms-of-service}" class="footer-link d-inline">Terms of Service</a>
              <a th:href="@{/refund-policy}" class="footer-link d-inline">Refund Policy</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script>
    // Payment options functionality
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Payment options initializing...');
      
      // Get all payment type buttons
      const paymentTypeBtns = document.querySelectorAll('.payment-type-btn');
      const paymentFormContainer = document.querySelector('.payment-form-container');
      const paymentTypeInput = document.createElement('input');
      paymentTypeInput.type = 'hidden';
      paymentTypeInput.id = 'paymentType';
      paymentFormContainer.prepend(paymentTypeInput);
      
      // Add click handlers for payment type buttons
      paymentTypeBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          // Remove active class from all buttons
          paymentTypeBtns.forEach(b => b.classList.remove('active', 'btn-primary', 'btn-success'));
          
          // Add appropriate active class based on button type
          const type = this.getAttribute('data-type');
          if (type === 'partial') {
            this.classList.add('active', 'btn-primary');
            paymentTypeInput.value = 'partial';
          } else {
            this.classList.add('active', 'btn-success');
            paymentTypeInput.value = 'advance';
          }
          
          // Show payment form if not already visible
          if (paymentFormContainer.style.display === 'none') {
            paymentFormContainer.style.display = 'block';
            
            // Smooth scroll to payment form on mobile
            if (window.innerWidth <= 768) {
              paymentFormContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
          }
        });
      });
      
      // Initialize payment type to partial by default
      const partialBtn = document.querySelector('[data-type="partial"]');
      if (partialBtn) {
        partialBtn.click();
      }
      
      // Payment form submission
      const customPayBtn = document.getElementById('customPayBtn');
      const qrPayBtn = document.getElementById('qrPayBtn');
      
      if (customPayBtn) {
        customPayBtn.addEventListener('click', function(e) {
          e.preventDefault();
          initiateCustomPayment();
        });
      }
      
      if (qrPayBtn) {
        qrPayBtn.addEventListener('click', function(e) {
          e.preventDefault();
          const amountInput = document.getElementById('customPaymentAmount');
          if (amountInput && amountInput.value) {
            showQRCode();
          } else {
            alert('Please enter an amount first');
            amountInput.focus();
          }
        });
      }
      
      // Make functions globally available
      window.initiateCustomPayment = function() {
        console.log('initiateCustomPayment called');
        const amountInput = document.getElementById('customPaymentAmount');
        const amount = parseFloat(amountInput.value);
        const paymentType = document.getElementById('paymentType').value || 'partial';
        
        if (!amount || amount < 1) {
          alert('Please enter a valid amount (minimum ₹1)');
          return;
        }
        
        const originalText = customPayBtn.innerHTML;
        customPayBtn.disabled = true;
        customPayBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-1"></span>Processing...';
        
        // Here you would typically make an AJAX call to process the payment
        console.log(`Processing ${paymentType} payment for amount:`, amount);
        
        // Simulate API call
        setTimeout(function() {
          alert(`${paymentType === 'partial' ? 'Partial' : 'Advance'} payment of ₹${amount} processed successfully!`);
          customPayBtn.disabled = false;
          customPayBtn.innerHTML = originalText;
        }, 1500);
      };
    });
    function initiateCustomPayment() {
      const amountInput = document.getElementById('customPaymentAmount');
      const amount = parseFloat(amountInput.value);
      
      if (!amount || amount < 1) {
        alert('Please enter a valid amount (minimum ₹1)');
        return;
      }
      
      // Disable button and show loading
      const payBtn = document.getElementById('customPayBtn');
      const originalText = payBtn.innerHTML;
      payBtn.disabled = true;
      payBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-1"></span>Processing...';
      
      // Create order via backend
      fetch('/payment/create-custom-order', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ amount: amount })
      })
      .then(response => response.json())
      .then(data => {
        if (data.error) {
          alert('Error: ' + data.error);
          payBtn.disabled = false;
          payBtn.innerHTML = originalText;
          return;
        }
        
        // Open Razorpay checkout
        const options = {
          key: data.keyId,
          amount: data.amountPaise,
          currency: 'INR',
          name: 'HappyGhumakkads',
          description: 'Custom Payment',
          order_id: data.orderId,
          prefill: {
            name: data.customerName || '',
            email: data.customerEmail || '',
            contact: data.customerPhone || ''
          },
          theme: { color: '#10b981' },
          handler: function (response) {
            // Payment successful
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = '/payment/custom-success';
            
            for (const [k, v] of Object.entries(response)) {
              const input = document.createElement('input');
              input.type = 'hidden';
              input.name = k;
              input.value = v;
              form.appendChild(input);
            }
            
            const amountField = document.createElement('input');
            amountField.type = 'hidden';
            amountField.name = 'paidAmount';
            amountField.value = amount;
            form.appendChild(amountField);
            
            document.body.appendChild(form);
            form.submit();
          },
          modal: {
            ondismiss: function() {
              payBtn.disabled = false;
              payBtn.innerHTML = originalText;
              alert('Payment cancelled');
            }
          }
        };
        
        const rzp = new Razorpay(options);
        rzp.on('payment.failed', function (response) {
          alert('Payment failed: ' + response.error.description);
          payBtn.disabled = false;
          payBtn.innerHTML = originalText;
        });
        
        rzp.open();
      })
      .catch(error => {
        console.error('Error:', error);
        alert('Failed to initiate payment. Please try again.');
        payBtn.disabled = false;
        payBtn.innerHTML = originalText;
      });
    }
  </script>
</div>
